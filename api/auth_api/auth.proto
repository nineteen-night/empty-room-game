syntax = "proto3";

package auth.service.v1;
option go_package = "github.com/nineteen-night/empty-room-game/internal/auth/pb/auth_api";

import "models/auth_model.proto";
import "google/api/annotations.proto";

service AuthService {
    // Регистрация и вход
    rpc Register (RegisterRequest) returns (RegisterResponse) {
        option (google.api.http) = {
            post: "/auth/register"
            body: "*"
        };
    }

    rpc Login (LoginRequest) returns (LoginResponse) {
        option (google.api.http) = {
            post: "/auth/login"
            body: "*"
        };
    }

    // Управление партнёрствами
    rpc CreatePartnership (CreatePartnershipRequest) returns (CreatePartnershipResponse) {
        option (google.api.http) = {
            post: "/partnership"
            body: "*"
        };
    }

    rpc TerminatePartnership (TerminatePartnershipRequest) returns (TerminatePartnershipResponse) {
        option (google.api.http) = {
            delete: "/partnership/{partnership_id}"
        };
    }

    // Получение информации о пользователе
    rpc GetUser (GetUserRequest) returns (GetUserResponse) {
        option (google.api.http) = {
            get: "/user/{user_id}"
        };
    }
}

// Регистрация
message RegisterRequest {
    string username = 1;
    string email = 2;
    string password = 3;
}

message RegisterResponse {
    auth.models.v1.User user = 1;
}

// Вход
message LoginRequest {
    string username = 1;
    string password = 2;
}

message LoginResponse {
    auth.models.v1.User user = 1;
}

// Партнёрства
message CreatePartnershipRequest {
    string user_id = 1;
    string partner_username = 2;
}

message CreatePartnershipResponse {
    auth.models.v1.Partnership partnership = 1;
}

message TerminatePartnershipRequest {
    string partnership_id = 1;
}

message TerminatePartnershipResponse {
    bool success = 1;
}

// Пользователь
message GetUserRequest {
    string user_id = 1;
}

message GetUserResponse {
    auth.models.v1.User user = 1;
}